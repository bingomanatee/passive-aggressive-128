<script language="javascript">
    window._pa_search_query = {
        zip: '<%= zip %>',
        category: '<%= category %>'
    };

</script>
<div ng-app="paApp">
    <div ng-controller="paEventsCtrl" ng-cloak id="paEventsCtrl">
        <h1>{{category_label()}} in zip {{place_label()}} </h1>

        <div>
            <label for="search-input">Search</label>
            <input type="text" class="input input-xlarge" placeholder="Search" id="search-input"
                   ng-model="search_term.title"/>

        </div>

        <span ng-repeat="event in events | filter: search_term">
            <button ng-hide="event.expand" ng-click="expand_event(event)" class="btn btn-sm">{{ event.title }}</button>
            <div ng-show="event.expand">
                <h2>{{ event.title }}</h2>

                <p>{{ event_text(event) }} </p>

                <dl>
                    <dt ng-repeat-start="time in event.times">{{time.venue_name }}</dt>
                    <dd ng-repeat-end>{{time.start_time}}</dd>
                </dl>
                <div ng-repeat="time in event.times">{{time.venu_name}}: {{time.start_time}}</div>
                <button ng-click="close_event(event)">&times; close</button>
            </div>
        </span>
    </div>
</div>