<% if (events ) { %><h1>Search again</h1><% } else { %><h1>Search for events </h1><% } %>

<form class="form-horizontal" id="event-search-form" method="POST" action="/search">
    <div class="control-group">
        <label class="control-label" for="search-input">Location</label>

        <div class="controls">
            <input type="text" name="location" id="location-input" required placeholder="Search for location">
            <p>Within <input type="number" min="0" max="10000" name="radius" value="10" /> miles</p>
        </div>
    </div>

    <div class="control-group">
        <label class="control-label" for="search-input">Search Term</label>

        <div class="controls">
            <input type="text" name="search" id="search-input" required placeholder="Search for events">
        </div>
    </div>
    <div class="control-group">
        <div class="controls">
            <button type="submit" class="btn">Search for Events</button>
        </div>
    </div>
</form>

<% if (events) { %>
<h2><%= events.total_items %> Results: (page <%= events.page_number %> of <%= events.page_count %>)</h2>

<% if (false) { %>
<pre>
            <%- JSON.stringify(events.events, true, 3) %>

        </pre>
<% } // if false
%>
<style>
    .event-listing tbody td {
        vertical-align: top;
        font-size: 85%;

    }

    .event-listing thead th {
        font-size: 100%;
        text-transform: uppercase;
        text-align: left;
        vertical-align: top;
    }

    .event-listing .title {
        font-weight: bold;
        font-size: 120%;
        padding: 0em 2em 0em 1em;
    }

    .event-listing .venue {
        min-width: 30em;
        font-weight: bold;
    }

    .event-listing .venue h3 {
        font-size: 100%;
        marign: 0;
        pardding: 0;
        margin-bottom: 0.5em;
        color: magenta;
    }
</style>
<table class="event-listing">
    <thead>
    <tr>
        <th>Venue</th>
        <th>Description</th>
    </tr>

    </thead>

    <tbody>
    <% events.events.event.forEach(function(e){ %>
    <tr>
        <td colspan="2" class="title"><%= e.title %></td>
    </tr>
    <tr>
        <td class="venue"><h3><%= e.venue_name %></h3>
            <address>
                <% if (e.venu_address) { %><%= e.venue_address %><br/> <% } %>
                <%= e.city_name %>, <%= e.region_name %> <% if (e.postal_code ){ %> <%= e.postal_code %> <% } %>
            </address>
            <% if (e.start_time && e.end_time){%>
            <dl>
                <dt>from</dt>
                <dd><%= e.start_time %></dd>
                <dt>to</dt>
                <dd><%= e.end_time %></dd>
            </dl>
            <% } else if (e.start_time) { %>

            <dl>
                <dt>at</dt>
                <dd><%= e.start_time %></dd>
            </dl>
            <% } %>
        </td>
        <td><%- e.description %></td>
    </tr>

    <% })// end foreach
    %>
    </tbody>
</table>
<% } // if events
%>
